<script type="text/javascript"
        src="https://cdn.jsdelivr.net/npm/@clappr/player@latest/dist/clappr.min.js">
</script>
<div id="player"></div>
<script>
    var player = new Clappr.Player({
        source: "https://edge01.iptv.digijadoo.net/live/atn_bangla/playlist.m3u8?md5=2fFJ1dVYjxxiM82fJmoD7Q&expires=1726797721&user=c15be118d93a464dabf77260596012cf", 
        parentId: "#player",
        poster: 'http://clappr.io/poster.png',
        autoPlay: true,
        playback: {
            hlsjsConfig: {
                fragLoadingMaxRetry: 3,  // Retry fragment loading 3 times before error
                fragLoadingRetryDelay: 1000,  // Retry delay
                enableWorker: true,  // Use workers to improve performance
                liveSyncDurationCount: 3,  // Keep sync with live stream
                liveMaxLatencyDurationCount: 5  // Max allowable latency before syncing
            }
        }
    });

    // Listen for errors and smoothly reload stream without viewer noticing
    player.on(Clappr.Events.PLAYER_ERROR, function() {
        console.warn('Error detected, trying to reload the stream seamlessly...');
        reloadStreamSeamlessly();
    });

    // Seamless reload by reloading the source in the background without disrupting playback
    function reloadStreamSeamlessly() {
        var currentTime = player.getCurrentTime();  // Capture current playback time
        var source = player.options.source;  // Get current source
        
        player.configure({
            source: source,
            startPosition: currentTime,  // Resume at the same position
            autoPlay: true
        });

        console.log('Stream reloaded seamlessly at time:', currentTime);
    }
</script>
